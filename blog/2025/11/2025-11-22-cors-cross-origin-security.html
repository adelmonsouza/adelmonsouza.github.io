<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Day 22/30 â€” CORS &amp; Cross-Origin Security Â· The Java Place</title>
  <meta name="description" content="Day 22 do #30DiasJava: ConfiguraÃ§Ã£o de CORS, seguranÃ§a cross-origin, preflight requests, e como permitir que frontend e mobile acessem a API de forma segura." />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="canonical" href="https://enouveau.io/blog/2025/11/2025-11-22-cors-cross-origin-security.html" />
  <meta property="og:title" content="Day 22/30 â€” CORS &amp; Cross-Origin Security" />
  <meta property="og:description" content="Day 22 do #30DiasJava: ConfiguraÃ§Ã£o de CORS, seguranÃ§a cross-origin, preflight requests, e como permitir que frontend e mobile acessem a API de forma segura." />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://enouveau.io/blog/2025/11/2025-11-22-cors-cross-origin-security.html" />
  <meta property="article:published_time" content="2025-11-22T00:00:00.000Z" />
  <meta property="article:tag" content="Spring Boot" />
  <meta property="article:tag" content="CORS" />
  <meta property="article:tag" content="Security" />
  <meta property="article:tag" content="Web Security" />
  <meta property="article:tag" content="API Design" />
</head>
<body>
  <div class="background-glow"></div>
  <div class="app-shell">
    <header class="masthead">
  <div class="brand">
    <a href="/" style="display: inline-flex; align-items: center; gap: 12px; font-weight: 600; font-size: 1.5rem; color: var(--text-primary); letter-spacing: 0.02em; text-decoration: none;">
      <span>ğŸš€</span>
      <span>The Java Place</span>
    </a>
  </div>
  <nav class="main-nav">
    <a href="/">Home</a>
    <a href="/blog/">Blog</a>
    <a href="/blog/about.html">Sobre</a>
    <a href="/start-line/season-1-becoming-developer.html">Start Line</a>
    <a href="/resources/">Resources</a>
  </nav>
</header>
    
      
      <nav class="breadcrumbs" style="margin-bottom: 1.5rem; font-size: 0.9rem; color: var(--text-secondary);">
        <a href="/">Home</a>
        <span> / </span>
        <a href="/blog/">Blog</a>
        <span> / </span>
        <span>Day 22/30 â€” CORS &amp; Cross-Origin Security</span>
      </nav>
    
      <a class="back-link" href="/blog/">&larr; Voltar para o blog</a>
      
      <div class="audio-player" style="margin: 2rem 0; padding: 1.5rem; background: rgba(139, 92, 246, 0.1); border-radius: 16px; border: 1px solid rgba(139, 92, 246, 0.3);">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
          <span style="font-size: 1.5rem;">ğŸ™ï¸</span>
          <h3 style="margin: 0; font-size: 1.1rem;">OuÃ§a este post</h3>
        </div>
        <div class="language-selector" style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
          <button class="lang-btn active" data-lang="pt" style="padding: 0.5rem 1rem; border: 1px solid rgba(139, 92, 246, 0.5); background: rgba(139, 92, 246, 0.2); color: #d8b4fe; border-radius: 8px; cursor: pointer;">ğŸ‡§ğŸ‡· PortuguÃªs</button>
          <button class="lang-btn" data-lang="fr" style="padding: 0.5rem 1rem; border: 1px solid rgba(139, 92, 246, 0.5); background: transparent; color: var(--text-secondary); border-radius: 8px; cursor: pointer;">ğŸ‡«ğŸ‡· FranÃ§ais</button>
          <button class="lang-btn" data-lang="en" style="padding: 0.5rem 1rem; border: 1px solid rgba(139, 92, 246, 0.5); background: transparent; color: var(--text-secondary); border-radius: 8px; cursor: pointer;">ğŸ‡¬ğŸ‡§ English</button>
        </div>
        <audio id="podcast-audio" controls style="width: 100%; margin-bottom: 0.5rem;">
          <source src="/blog/audio/2025-11-22-cors-cross-origin-security-pt.mp3" type="audio/mpeg" id="audio-source-pt">
          <source src="/blog/audio/2025-11-22-cors-cross-origin-security-fr.mp3" type="audio/mpeg" id="audio-source-fr">
          <source src="/blog/audio/2025-11-22-cors-cross-origin-security-en.mp3" type="audio/mpeg" id="audio-source-en">
          Seu navegador nÃ£o suporta Ã¡udio HTML5.
        </audio>
        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; color: var(--text-secondary);">
          <a href="/blog/audio/2025-11-22-cors-cross-origin-security-pt.mp3" download style="color: var(--link); text-decoration: none;">ğŸ“¥ Baixar episÃ³dio</a>
          <span id="audio-status">Idioma: PortuguÃªs</span>
        </div>
      </div>
      <script>
        (function() {
          const langButtons = document.querySelectorAll('.lang-btn');
          const audio = document.getElementById('podcast-audio');
          const status = document.getElementById('audio-status');
          const sources = {
            pt: document.getElementById('audio-source-pt'),
            fr: document.getElementById('audio-source-fr'),
            en: document.getElementById('audio-source-en')
          };
          const langNames = { pt: 'PortuguÃªs', fr: 'FranÃ§ais', en: 'English' };
          
          langButtons.forEach(btn => {
            btn.addEventListener('click', function() {
              const lang = this.dataset.lang;
              langButtons.forEach(b => {
                b.classList.remove('active');
                b.style.background = 'transparent';
                b.style.color = 'var(--text-secondary)';
              });
              this.classList.add('active');
              this.style.background = 'rgba(139, 92, 246, 0.2)';
              this.style.color = '#d8b4fe';
              
              if (sources[lang]) {
                audio.src = sources[lang].src;
                audio.load();
                status.textContent = 'Idioma: ' + langNames[lang];
              }
            });
          });
        })();
      </script>
    
      <article class="article">
        <header>
          <span class="pill">30DaysOfJava</span>
          <h1>Day 22/30 â€” CORS &amp; Cross-Origin Security</h1>
          <p>Day 22 do #30DiasJava: ConfiguraÃ§Ã£o de CORS, seguranÃ§a cross-origin, preflight requests, e como permitir que frontend e mobile acessem a API de forma segura.</p>
          <div class="meta-line">
            <span>ğŸ“… 22 de novembro de 2025</span>
            <span>â±ï¸ 9 min read</span>
            <span>ğŸ—‚ï¸ 30DaysOfJava</span>
          </div>
        </header>
        <div class="article-body">
          <blockquote>
<p>&quot;CORS nÃ£o Ã© um bug, Ã© uma feature de seguranÃ§a. Entender CORS Ã© entender como o navegador protege vocÃª de sites maliciosos.&quot; â€” <em>#30DiasJava Security Notes</em></p>
</blockquote>
<h2>ğŸ¯ Por que CORS Ã© Importante?</h2>
<p>Imagine que vocÃª estÃ¡ logado no seu banco online (banco.com) e, ao mesmo tempo, visita um site malicioso (site-malicioso.com). Sem CORS, o site malicioso poderia fazer requisiÃ§Ãµes para o banco.com usando seus cookies de autenticaÃ§Ã£o e roubar seus dados. O navegador bloqueia isso por padrÃ£o.</p>
<p><strong>Exemplo do mundo real</strong>: Quando vocÃª acessa uma API de um frontend React rodando em <code>localhost:5173</code>, o navegador bloqueia a requisiÃ§Ã£o porque a API estÃ¡ em <code>localhost:8080</code> (origem diferente). Isso Ã© o CORS protegendo vocÃª. Mas para nossa aplicaÃ§Ã£o funcionar, precisamos configurar o CORS corretamente.</p>
<p><strong>No nosso projeto</strong>: Temos:</p>
<ul>
<li>Frontend React rodando em <code>http://localhost:5173</code></li>
<li>Backend Spring Boot rodando em <code>http://localhost:8080</code></li>
<li>Mobile app (Expo) que tambÃ©m precisa acessar a API</li>
</ul>
<p>Sem CORS configurado, o navegador bloqueia todas as requisiÃ§Ãµes entre frontend e backend. Com CORS configurado corretamente, permitimos que apenas origens confiÃ¡veis acessem nossa API.</p>
<h2>ğŸ¯ Objetivo do Day 22</h2>
<p>O Day 22 do #30DiasJava implementou uma <strong>configuraÃ§Ã£o completa de CORS</strong> que permite que frontend e mobile acessem a API de forma segura, bloqueando requisiÃ§Ãµes de origens nÃ£o autorizadas.</p>
<h2>ğŸ› ï¸ O que foi implementado</h2>
<h3>âœ… Checklist de ImplementaÃ§Ã£o</h3>
<p>1ï¸âƒ£ <strong>CORS Configuration</strong> com origins permitidas configurÃ¡veis
2ï¸âƒ£ <strong>MÃ©todos HTTP</strong> permitidos (GET, POST, PUT, DELETE, OPTIONS, PATCH)
3ï¸âƒ£ <strong>Headers permitidos</strong> (Authorization, Content-Type, etc.)
4ï¸âƒ£ <strong>Preflight caching</strong> (1 hora) para reduzir requisiÃ§Ãµes OPTIONS
5ï¸âƒ£ <strong>IntegraÃ§Ã£o com Spring Security</strong> no SecurityFilterChain</p>
<h3>âœ… CORS Configuration</h3>
<ul>
<li><strong>Origins permitidas</strong>: Lista configurÃ¡vel de origens confiÃ¡veis</li>
<li><strong>MÃ©todos HTTP</strong>: GET, POST, PUT, DELETE, OPTIONS, PATCH</li>
<li><strong>Headers permitidos</strong>: Authorization, Content-Type, etc.</li>
<li><strong>Credentials</strong>: Suporte para cookies e autenticaÃ§Ã£o</li>
<li><strong>Preflight caching</strong>: Cache de requisiÃ§Ãµes OPTIONS por 1 hora</li>
</ul>
<h3>âœ… Perfis de Ambiente</h3>
<ul>
<li><strong>Desenvolvimento</strong>: Permite todas as origens (para facilitar desenvolvimento)</li>
<li><strong>ProduÃ§Ã£o</strong>: Apenas origens especÃ­ficas permitidas</li>
<li><strong>ConfiguraÃ§Ã£o via properties</strong>: FÃ¡cil de ajustar sem mudar cÃ³digo</li>
</ul>
<h3>âœ… IntegraÃ§Ã£o com Spring Security</h3>
<ul>
<li><strong>CORS no SecurityFilterChain</strong>: Integrado com autenticaÃ§Ã£o JWT</li>
<li><strong>Headers expostos</strong>: Authorization, X-Total-Count para paginaÃ§Ã£o</li>
<li><strong>Suporte a credentials</strong>: Cookies e tokens de autenticaÃ§Ã£o</li>
</ul>
<h2>ğŸ“Š Como CORS Funciona</h2>
<h3>O Problema</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend           â”‚         â”‚  Backend API        â”‚
â”‚  localhost:5173     â”‚ â”€â”€â”€â”€â”€â”€X â”‚  localhost:8080     â”‚
â”‚  (Origem A)         â”‚ BLOQUEADOâ”‚  (Origem B)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Por quÃª bloqueado?</strong></p>
<ul>
<li>Navegador detecta que origem Ã© diferente</li>
<li>Por seguranÃ§a, bloqueia a requisiÃ§Ã£o</li>
<li>Erro no console: &quot;CORS policy blocked&quot;</li>
</ul>
<h3>A SoluÃ§Ã£o</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend           â”‚         â”‚  Backend API        â”‚
â”‚  localhost:5173     â”‚ â”€â”€â”€â”€â”€â”€âœ“ â”‚  localhost:8080     â”‚
â”‚  (Origem A)         â”‚ PERMITIDOâ”‚  (Origem B)        â”‚
â”‚                     â”‚         â”‚  + CORS configurado â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Como funciona?</strong></p>
<ol>
<li>Frontend faz requisiÃ§Ã£o para backend</li>
<li>Backend verifica se origem estÃ¡ na lista permitida</li>
<li>Se sim, retorna headers CORS permitindo a requisiÃ§Ã£o</li>
<li>Navegador vÃª os headers e permite a requisiÃ§Ã£o</li>
</ol>
<h2>ğŸ” Preflight Requests</h2>
<p>Quando vocÃª faz uma requisiÃ§Ã£o &quot;complexa&quot; (POST com JSON, DELETE, etc.), o navegador primeiro faz uma requisiÃ§Ã£o <strong>OPTIONS</strong> para perguntar ao servidor: &quot;Posso fazer esta requisiÃ§Ã£o?&quot;</p>
<pre><code>1. Frontend: POST /api/familias (com JSON)
   â†“
2. Navegador: OPTIONS /api/familias (preflight)
   â†“
3. Backend: Responde com headers CORS permitindo
   â†“
4. Navegador: Agora faz o POST real
</code></pre>
<p><strong>Por quÃª isso existe?</strong></p>
<ul>
<li>SeguranÃ§a: Servidor pode negar requisiÃ§Ãµes perigosas antes que aconteÃ§am</li>
<li>Performance: Cache da resposta preflight por 1 hora (nÃ£o precisa perguntar toda vez)</li>
</ul>
<h2>ğŸ’» ImplementaÃ§Ã£o</h2>
<h3>SecurityConfig.java</h3>
<pre><code class="language-java">package com.adelmonsouza.desafio.config;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;

import java.util.Arrays;
import java.util.List;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Lista de origens permitidas (configurÃ¡vel via application.yml)
    @Value(&quot;${app.security.cors.allowed-origins:http://localhost:5173,http://192.168.0.104:8080}&quot;)
    private String allowedOrigins;

    /**
     * ConfiguraÃ§Ã£o de CORS.
     * 
     * O que Ã© CORS?
     * - Cross-Origin Resource Sharing
     * - Permite que frontend (origem diferente) acesse a API
     * - Bloqueia requisiÃ§Ãµes de origens nÃ£o autorizadas
     * 
     * Por quÃª precisamos?
     * - Frontend React roda em localhost:5173
     * - Backend Spring Boot roda em localhost:8080
     * - Navegador bloqueia requisiÃ§Ãµes entre origens diferentes
     * - CORS diz ao navegador: &quot;Esta origem Ã© confiÃ¡vel&quot;
     */
    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        
        // Converter string de origens em lista
        List&lt;String&gt; origins = Arrays.asList(allowedOrigins.split(&quot;,&quot;));
        
        // Em desenvolvimento, permitir todas as origens
        // (Ãºtil para testar com mobile/Expo em diferentes IPs)
        if (isDevProfile() || origins.isEmpty() || origins.contains(&quot;*&quot;)) {
            configuration.addAllowedOriginPattern(&quot;*&quot;);  // Permite qualquer origem
        } else {
            // Em produÃ§Ã£o, apenas origens especÃ­ficas
            configuration.setAllowedOrigins(origins);
        }
        
        // MÃ©todos HTTP permitidos
        configuration.setAllowedMethods(Arrays.asList(
            &quot;GET&quot;,    // Buscar dados
            &quot;POST&quot;,   // Criar dados
            &quot;PUT&quot;,    // Atualizar dados
            &quot;DELETE&quot;, // Deletar dados
            &quot;OPTIONS&quot;, // Preflight requests
            &quot;PATCH&quot;   // AtualizaÃ§Ã£o parcial
        ));
        
        // Headers permitidos
        configuration.setAllowedHeaders(Arrays.asList(
            &quot;Authorization&quot;,  // Token JWT
            &quot;Content-Type&quot;,   // Tipo de conteÃºdo (JSON, etc.)
            &quot;X-Requested-With&quot;, // Identifica requisiÃ§Ãµes AJAX
            &quot;Accept&quot;,         // Tipos de resposta aceitos
            &quot;Origin&quot;          // Origem da requisiÃ§Ã£o
        ));
        
        // Headers que o frontend pode ler
        configuration.setExposedHeaders(Arrays.asList(
            &quot;Authorization&quot;,  // Token JWT (se necessÃ¡rio)
            &quot;X-Total-Count&quot;   // Total de registros (para paginaÃ§Ã£o)
        ));
        
        // Permitir cookies e autenticaÃ§Ã£o
        // IMPORTANTE: SÃ³ funciona se allowedOrigins for especÃ­fico (nÃ£o &quot;*&quot;)
        configuration.setAllowCredentials(true);
        
        // Cache de preflight requests por 1 hora
        // Reduz nÃºmero de requisiÃ§Ãµes OPTIONS
        configuration.setMaxAge(3600L);
        
        // Aplicar configuraÃ§Ã£o para todos os endpoints
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration(&quot;/**&quot;, configuration);
        
        return source;
    }

    /**
     * SecurityFilterChain - Integra CORS com autenticaÃ§Ã£o.
     */
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            // Desabilitar CSRF (APIs REST stateless com JWT nÃ£o precisam)
            .csrf(csrf -&gt; csrf.disable())
            
            // Configurar CORS
            .cors(cors -&gt; cors.configurationSource(corsConfigurationSource()))
            
            // ... outras configuraÃ§Ãµes de seguranÃ§a
            
        return http.build();
    }

    private boolean isDevProfile() {
        String activeProfiles = System.getProperty(&quot;spring.profiles.active&quot;, &quot;&quot;);
        return Arrays.asList(activeProfiles.split(&quot;,&quot;)).contains(&quot;dev&quot;);
    }
}
</code></pre>
<h3>application.yml</h3>
<pre><code class="language-yaml"># ConfiguraÃ§Ã£o de CORS
app:
  security:
    cors:
      # Lista de origens permitidas (separadas por vÃ­rgula)
      # Em desenvolvimento, pode usar &quot;*&quot; para permitir todas
      allowed-origins: |
        http://localhost:5173,
        http://localhost:3000,
        http://192.168.0.104:8080,
        https://enouveau.io,
        https://www.enouveau.io
</code></pre>
<h2>ğŸ“ˆ Exemplos de RequisiÃ§Ãµes</h2>
<h3>RequisiÃ§Ã£o Simples (GET)</h3>
<pre><code>Frontend â†’ Backend:
GET /api/familias
Origin: http://localhost:5173

Backend â†’ Frontend:
HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:5173
Access-Control-Allow-Credentials: true
Content-Type: application/json

[... dados ...]
</code></pre>
<h3>RequisiÃ§Ã£o Complexa (POST com Preflight)</h3>
<pre><code>1. Preflight (OPTIONS):
Frontend â†’ Backend:
OPTIONS /api/familias
Origin: http://localhost:5173
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Content-Type, Authorization

Backend â†’ Frontend:
HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://localhost:5173
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS
Access-Control-Allow-Headers: Authorization, Content-Type
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 3600

2. RequisiÃ§Ã£o Real (POST):
Frontend â†’ Backend:
POST /api/familias
Origin: http://localhost:5173
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
Content-Type: application/json

{&quot;nome&quot;: &quot;FamÃ­lia Silva&quot;}

Backend â†’ Frontend:
HTTP/1.1 201 Created
Access-Control-Allow-Origin: http://localhost:5173
Access-Control-Allow-Credentials: true
Content-Type: application/json

{&quot;id&quot;: 1, &quot;nome&quot;: &quot;FamÃ­lia Silva&quot;, ...}
</code></pre>
<h2>ğŸ§  Insight Principal</h2>
<blockquote>
<p><strong>&quot;CORS nÃ£o Ã© um bug, Ã© uma feature de seguranÃ§a. Entender CORS Ã© entender como o navegador protege vocÃª de sites maliciosos.&quot;</strong></p>
</blockquote>
<h3>Por quÃª isso importa?</h3>
<ol>
<li><p><strong>SeguranÃ§a</strong></p>
<ul>
<li>Sem CORS: Qualquer site pode fazer requisiÃ§Ãµes, ataques CSRF, roubo de dados</li>
<li>Com CORS: Apenas origens autorizadas, navegador bloqueia requisiÃ§Ãµes nÃ£o autorizadas, proteÃ§Ã£o automÃ¡tica</li>
</ul>
</li>
<li><p><strong>Compatibilidade com Frontend e Mobile</strong></p>
<ul>
<li>Sem CORS: Frontend React nÃ£o funciona, mobile app nÃ£o funciona, erro &quot;CORS policy blocked&quot;</li>
<li>Com CORS: Frontend funciona normalmente, mobile app funciona, requisiÃ§Ãµes permitidas</li>
</ul>
</li>
<li><p><strong>Flexibilidade</strong></p>
<ul>
<li>Desenvolvimento: Permite todas as origens (facilita testes)</li>
<li>ProduÃ§Ã£o: Apenas origens especÃ­ficas (seguranÃ§a)</li>
</ul>
</li>
</ol>
<h2>ğŸ“ˆ Resultados Reais</h2>
<ul>
<li><strong>RequisiÃ§Ãµes bloqueadas</strong>: 0 (antes: 100% bloqueadas)</li>
<li><strong>Frontend funcional</strong>: âœ… React consegue acessar API</li>
<li><strong>Mobile funcional</strong>: âœ… Expo consegue acessar API</li>
<li><strong>SeguranÃ§a mantida</strong>: âœ… Apenas origens autorizadas</li>
</ul>
<h2>âš ï¸ Erros Comuns e SoluÃ§Ãµes</h2>
<h3>Erro: &quot;CORS policy blocked&quot;</h3>
<p><strong>Causa</strong>: Origem nÃ£o estÃ¡ na lista permitida</p>
<p><strong>SoluÃ§Ã£o</strong>: Adicionar origem em <code>application.yml</code>:</p>
<pre><code class="language-yaml">app:
  security:
    cors:
      allowed-origins: http://localhost:5173,http://localhost:3000
</code></pre>
<h3>Erro: &quot;Credentials not allowed&quot;</h3>
<p><strong>Causa</strong>: <code>allowCredentials: true</code> com <code>allowedOrigins: [&quot;*&quot;]</code></p>
<p><strong>SoluÃ§Ã£o</strong>: Usar <code>allowedOriginPatterns: [&quot;*&quot;]</code> ou especificar origens:</p>
<pre><code class="language-java">// âŒ NÃ£o funciona
configuration.setAllowedOrigins(Arrays.asList(&quot;*&quot;));
configuration.setAllowCredentials(true);

// âœ… Funciona
configuration.addAllowedOriginPattern(&quot;*&quot;);
configuration.setAllowCredentials(true);

// âœ… Ou melhor ainda (produÃ§Ã£o)
configuration.setAllowedOrigins(Arrays.asList(&quot;https://enouveau.io&quot;));
configuration.setAllowCredentials(true);
</code></pre>
<h3>Erro: &quot;Preflight request failed&quot;</h3>
<p><strong>Causa</strong>: Backend nÃ£o estÃ¡ respondendo OPTIONS corretamente</p>
<p><strong>SoluÃ§Ã£o</strong>: Verificar se CORS estÃ¡ configurado no SecurityFilterChain:</p>
<pre><code class="language-java">http.cors(cors -&gt; cors.configurationSource(corsConfigurationSource()));
</code></pre>
<h2>ğŸ“ LiÃ§Ãµes Aprendidas</h2>
<h3>âœ… O que funcionou bem</h3>
<ul>
<li><strong>ConfiguraÃ§Ã£o centralizada</strong>: Um Ãºnico lugar para gerenciar CORS</li>
<li><strong>Perfis de ambiente</strong>: Diferentes configuraÃ§Ãµes para dev/prod</li>
<li><strong>Preflight caching</strong>: Reduz requisiÃ§Ãµes desnecessÃ¡rias</li>
<li><strong>IntegraÃ§Ã£o com Spring Security</strong>: Funciona perfeitamente com JWT</li>
</ul>
<h3>âš ï¸ Desafios e soluÃ§Ãµes</h3>
<ul>
<li><strong>Mobile/Expo</strong>: Precisa permitir IPs dinÃ¢micos em desenvolvimento</li>
<li><strong>Credentials com wildcard</strong>: NÃ£o funciona, precisa especificar origens</li>
<li><strong>Cache de preflight</strong>: Pode causar problemas em desenvolvimento (reduzir maxAge)</li>
</ul>
<h2>ğŸ—ï¸ AplicaÃ§Ã£o no Desafio das Ãguias</h2>
<p><strong>Como isso melhorou o produto:</strong></p>
<ul>
<li><strong>Antes</strong>: Frontend e mobile nÃ£o conseguiam acessar API, erro &quot;CORS policy blocked&quot;</li>
<li><strong>Depois</strong>: Frontend React e mobile Expo funcionam perfeitamente, requisiÃ§Ãµes permitidas de forma segura</li>
<li><strong>Resultado</strong>: Sistema acessÃ­vel de qualquer origem autorizada, seguranÃ§a mantida</li>
</ul>
<p><strong>CÃ³digo no projeto:</strong></p>
<ul>
<li>Arquivo: <code>backend/src/main/java/com/adelmonsouza/desafio/config/SecurityConfig.java</code></li>
<li>ConfiguraÃ§Ã£o: <code>application.yml</code> â†’ <code>app.security.cors.allowed-origins</code></li>
<li>Branch: <code>feature/day-22-cors-configuration</code></li>
</ul>
<h2>ğŸ’¬ Pergunta para VocÃª</h2>
<p><strong>Como vocÃª configura CORS no seu projeto?</strong></p>
<ul>
<li>Usa configuraÃ§Ã£o global ou por endpoint?</li>
<li>Como lida com preflight requests?</li>
<li>Qual foi o erro de CORS mais difÃ­cil de resolver?</li>
</ul>
<p><strong>Compartilhe suas experiÃªncias nos comentÃ¡rios! ğŸ‘‡</strong></p>
<h2>ğŸ“š Recursos</h2>
<ul>
<li>MDN CORS Guide: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</a></li>
<li>Spring CORS Documentation: <a href="https://docs.spring.io/spring-framework/reference/web/webmvc-cors.html">https://docs.spring.io/spring-framework/reference/web/webmvc-cors.html</a></li>
<li>CORS Explained: <a href="https://www.codecademy.com/article/what-is-cors">https://www.codecademy.com/article/what-is-cors</a></li>
</ul>
<h2>ğŸ”— Links</h2>
<ul>
<li>RepositÃ³rio: <a href="https://github.com/adelmonsouza/30DiasJava-Day22-CORS">https://github.com/adelmonsouza/30DiasJava-Day22-CORS</a></li>
<li>Artigo completo: <a href="https://enouveau.io/blog/2025/11/22/cors-cross-origin-security.html">https://enouveau.io/blog/2025/11/22/cors-cross-origin-security.html</a></li>
</ul>
<p><strong>Next episode</strong> â†’ Day 23/30 â€” Security Best Practices</p>

        </div>
        <footer class="meta-line">
          <span>Compartilhe no LinkedIn e marque @adelmon</span>
          <a href="https://github.com/adelmonsouza/30DiasJava-Day22-CORS" target="_blank" rel="noopener noreferrer nofollow">CÃ³digo no GitHub</a>
        </footer>
      </article>
      
      <nav class="post-navigation" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); display: flex; justify-content: space-between; gap: 2rem;">
        
          <div style="flex: 1;">
            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">â† Post anterior</div>
            <a href="/blog/2025/11/2025-11-21-openapi-swagger-documentation.html" style="color: var(--link); font-weight: 600; text-decoration: none;">Day 21/30 â€” OpenAPI/Swagger Documentation</a>
          </div>
        
        
          <div style="flex: 1; text-align: right;">
            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">PrÃ³ximo post â†’</div>
            <a href="/blog/2025/11/2025-11-23-java-learning-evolution.html" style="color: var(--link); font-weight: 600; text-decoration: none;">Day 23/30 â€” A EvoluÃ§Ã£o do Aprendizado Java: Com e Sem Spring</a>
          </div>
        
      </nav>
    
    
  </div>
  <footer class="site-footer">
  Â© 2025 E-Nouveau â€” The Java Place. Sem fluff, apenas engenharia de verdade.
</footer>
</body>
</html>